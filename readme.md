小説家になろう 小説ページカスタマイズ
====

# 概要
小説家になろうのページをカスタマイズするTampermonkeyスクリプトとCSS。Google Chromeの拡張機能TampermonkeyとStylishが必要です。Stylishはたぶん別の拡張で代替可能です。環境に合わせてください。

自分用に作っていたため機能が偏っていたり思わぬバグがあったりします。このReadmeも書きかけです。とりあえずバックアップも兼ねてpushした代物なので、ソースコードも雑なまま放置されている部分が多々あります。順次直して……いければいいなあ……。

# カスタムリーダー
小説のページをカスタマイズします。

## 使い方
TampermonkeyとStylishなどにそれぞれのファイルをぶち込んでください。

## 機能
- タイトル、サブタイトル、作者名、章名、本文の英数字などを半角に変換
- 既存のヘッダーを大きく改変
  - 既存の項目を削除
  - 二段重ねに表示、一段目にタイトルを表示して下スクロールで非表示
  - 二段目にはサブタイトル、番号、前後話リンク、ブックマーク、しおりを表示
- 固定表示フッターを追加
  - 作者名、章名、行数、文字数、スクロール位置を表示
  - スクロール位置はクリックすることで指定の位置にジャンプできる
- URLパラメータに "y=\d+" が指定されていた場合、その位置に移動
  - 例: http://ncode.syosetu.com/n0000aa/1/?y=1200
- 固定表示ツールボックスを追加
  - サブタイトル、本文、ルビの表示/非表示ボタン
    - サブタイトル非表示はネタバレ防止向けに実装
  - 選択範囲、ルビ付き文字、タイトル、サブタイトル、章名、URL、RSSをコピーするボタン
  - 閉じ括弧前の句点を削除したり三点リーダーを『……』にしたりダッシュを適切にするボタン
  - 構文を最適化するボタン(上記の置換の他、地の文を字下げしたり会話行の前後に余白をつけたりする)
  - 本文文字列置換ツール
- 暗色系配色CSS(好みに合わせてオンオフ)
  - Stylishが動的に追加するので、対象のstyle要素に合わせて実装を弄る必要があります。具体的には520行目あたり。

## 注意事項
- 「小説家になろう」のメンテナンス等によってページ構造が変化した場合、各機能に影響が出る可能性があります。
- 全角→半角変換や構文最適化などは作者の想定する文章構造を崩す可能性があります。

# オリジナルログ
小説の閲覧履歴を独自に記録し、404ページの http://ncode.syosetu.com/ を改変して履歴を表示します。各データの取得を最適化するため、動作には『カスタムリーダー』が必要です。ブラウザに保存されるLocalStorageを使用します。ブラウザ移行などの場合はインポート/エクスポート機能を使用してください。

オフラインで動作させる場合、jQueryとJSRenderをローカルで読み込めるように修正する必要があります。対応予定はありません。

『サーバーから取得』機能の利用にはローカルで動作させる専用サーバー『NarouProxy』が必要になります。めんどくさいのでスタンドアロンアプリを提供する予定はありません。『NarouProxy』は雑な実装なのでしばらく公開予定はありません。

# ライセンス
CC-BY 2.0で「小説家になろう」に帰属します。